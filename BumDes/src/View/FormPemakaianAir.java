/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View;

import Custom.FormatRibuan;
import Custom.RenderWarnaWarni;
import Custom.Tanggal;
import Kelas.Anggota;
import Kelas.Konfigurasi;
import Kelas.Pemakaian;
import Kelas.Profil;
import Kelas.Trans;
import Kelas.Transaksi;
import Koneksi.Koneksi;
import Kontrol.AnggotaKontrol;
import Kontrol.KonfigurasiKontrol;
import Kontrol.PemakaianKontrol;
import Kontrol.PengaturanKontrol;
import Kontrol.TransKontrol;
import Kontrol.TransaksiKontrol;
import TabelModel.AnggotaTM;
import TabelModel.HistoriTM;
import java.awt.Color;
import java.awt.Image;
import java.awt.Toolkit;
import java.io.File;
import java.io.IOException;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JOptionPane;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author damaikurnia
 */
public class FormPemakaianAir extends javax.swing.JFrame {

    Konfigurasi konfig;

    /**
     * Creates new form FormAir
     */
    public FormPemakaianAir() {
        try {
            initComponents();
            this.setLocationRelativeTo(null);
//            setExtendedState(this.getExtendedState() | JFrame.MAXIMIZED_BOTH);
            sinkronGambar();

            dialog_cariP.setVisible(false);
            dialog_cariP.setSize(673, 413);
            dialog_cariP.setLocationRelativeTo(null);
            dialog_cariP.setTitle("DATA ANGGOTA");

            dialog_cariPHistori.setVisible(false);
            dialog_cariPHistori.setSize(673, 413);
            dialog_cariPHistori.setLocationRelativeTo(null);
            dialog_cariPHistori.setTitle("DATA ANGGOTA");

            dialog_histori.setVisible(false);
            dialog_histori.setSize(1020, 600);
            dialog_histori.setLocationRelativeTo(null);
            dialog_histori.setTitle("FORM HISTORI PELANGGAN");

            label_noTrans.setVisible(true);
            label_tanggal.setText(Tanggal.getTanggal());
            String bulan = generateBulanTahun(Tanggal.getTanggal2());
            label_bulan.setText(bulan.split("-")[0]);
            text_airterakhir.setEditable(true);
            label_status.setVisible(false);

            konfig = KonfigurasiKontrol.getKoneksi().selectKonfigurasi();
            button_simpan.setEnabled(false);

            label_1.setVisible(false);
            label_2.setVisible(false);
            label_3.setVisible(false);
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        dialog_cariP = new javax.swing.JDialog();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        text_key = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        tabel_pelanggan = new javax.swing.JTable();
        dialog_histori = new javax.swing.JDialog();
        jPanel6 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jPanel7 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        text_DNoPelanggan = new javax.swing.JTextField();
        text_DNama = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        text_DDusun = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        text_DNoTelp = new javax.swing.JTextField();
        jScrollPane4 = new javax.swing.JScrollPane();
        text_DAlamat = new javax.swing.JTextArea();
        jLabel23 = new javax.swing.JLabel();
        text_DRT = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        text_DRW = new javax.swing.JTextField();
        button_cari = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        tabel_histori = new javax.swing.JTable();
        jLabel17 = new javax.swing.JLabel();
        dialog_cariPHistori = new javax.swing.JDialog();
        jPanel9 = new javax.swing.JPanel();
        jPanel10 = new javax.swing.JPanel();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        text_keyP2 = new javax.swing.JTextField();
        jScrollPane5 = new javax.swing.JScrollPane();
        tabel_pelangganP2 = new javax.swing.JTable();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        label_namaDesa = new javax.swing.JLabel();
        label_alamatNotelp = new javax.swing.JLabel();
        label_kop = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        label_noTrans = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        text_noPelanggan = new javax.swing.JTextField();
        button_pelanggan = new javax.swing.JButton();
        label_status = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        text_nama = new javax.swing.JTextField();
        text_airlunas = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        text_airterakhir = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        text_alamat = new javax.swing.JTextArea();
        button_simpan = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        button_histori = new javax.swing.JButton();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        label_tanggal = new javax.swing.JLabel();
        label_bulan = new javax.swing.JLabel();
        panel_perincian = new javax.swing.JPanel();
        jLabel27 = new javax.swing.JLabel();
        text_airdibayar = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        label_abodemen = new javax.swing.JLabel();
        label_pertama = new javax.swing.JLabel();
        label_kedua = new javax.swing.JLabel();
        label_ketiga = new javax.swing.JLabel();
        text_abodemen = new javax.swing.JTextField();
        text_pertama = new javax.swing.JTextField();
        text_kedua = new javax.swing.JTextField();
        text_ketiga = new javax.swing.JTextField();
        label_total = new javax.swing.JLabel();
        text_total = new javax.swing.JTextField();
        button_sama = new javax.swing.JButton();
        label_1 = new javax.swing.JLabel();
        label_2 = new javax.swing.JLabel();
        label_3 = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jMenu2 = new javax.swing.JMenu();
        jMenuItem3 = new javax.swing.JMenuItem();
        jMenuItem13 = new javax.swing.JMenuItem();
        jMenu3 = new javax.swing.JMenu();
        jMenuItem9 = new javax.swing.JMenuItem();
        jMenuItem10 = new javax.swing.JMenuItem();
        jMenuItem11 = new javax.swing.JMenuItem();
        jMenuItem7 = new javax.swing.JMenuItem();
        jMenu4 = new javax.swing.JMenu();
        jMenuItem1 = new javax.swing.JMenuItem();
        jMenuItem5 = new javax.swing.JMenuItem();
        jMenuItem6 = new javax.swing.JMenuItem();
        jMenu5 = new javax.swing.JMenu();
        jMenuItem4 = new javax.swing.JMenuItem();
        jMenuItem12 = new javax.swing.JMenuItem();
        jMenu6 = new javax.swing.JMenu();
        jMenuItem14 = new javax.swing.JMenuItem();
        jMenuItem8 = new javax.swing.JMenuItem();
        jMenuItem2 = new javax.swing.JMenuItem();

        dialog_cariP.getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel4.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel4.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel5.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel5.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel12.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel12.setText("DATA PELANGGAN");
        jPanel5.add(jLabel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 640, 40));

        jPanel4.add(jPanel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 660, 70));

        jLabel13.setText("KEYWORD");
        jPanel4.add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 100, 100, 20));

        text_key.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                text_keyKeyReleased(evt);
            }
        });
        jPanel4.add(text_key, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 100, 470, -1));

        tabel_pelanggan.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tabel_pelanggan.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tabel_pelangganMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tabel_pelanggan);

        jPanel4.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 140, 620, 210));

        dialog_cariP.getContentPane().add(jPanel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 660, 380));

        jPanel6.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jLabel7.setFont(new java.awt.Font("Dialog", 1, 24)); // NOI18N
        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel7.setText("HISTORI PELANGGAN");

        jLabel16.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel16.setText("PENGELOLAAN AIR BERSIH BADAN USAHA MILIK DESA (BUMDES)");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 991, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jLabel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jPanel7.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder("INFORMASI PELANGGAN"));

        jLabel18.setText("NO PELANGGAN");

        jLabel19.setText("NAMA");

        jLabel20.setText("ALAMAT");

        text_DNoPelanggan.setEditable(false);

        text_DNama.setEditable(false);

        jLabel21.setText("DUSUN");

        text_DDusun.setEditable(false);

        jLabel22.setText("TELP");

        text_DNoTelp.setEditable(false);

        text_DAlamat.setEditable(false);
        text_DAlamat.setColumns(20);
        text_DAlamat.setRows(5);
        jScrollPane4.setViewportView(text_DAlamat);

        jLabel23.setText("RT / RW");

        text_DRT.setEditable(false);

        jLabel24.setText("/");

        text_DRW.setEditable(false);

        button_cari.setText("...");
        button_cari.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_cariActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel18)
                    .addComponent(jLabel19)
                    .addComponent(jLabel20))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(text_DNama, javax.swing.GroupLayout.DEFAULT_SIZE, 260, Short.MAX_VALUE)
                    .addComponent(jScrollPane4)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(text_DNoPelanggan, javax.swing.GroupLayout.PREFERRED_SIZE, 216, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(button_cari, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(76, 76, 76)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jLabel22)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(text_DNoTelp, javax.swing.GroupLayout.PREFERRED_SIZE, 260, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel21)
                            .addComponent(jLabel23))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(text_DRT, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel24)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(text_DRW, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(text_DDusun, javax.swing.GroupLayout.PREFERRED_SIZE, 260, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_DNoPelanggan, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_DRT, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_DRW, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(button_cari))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel21, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(text_DDusun, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(text_DNoTelp, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(text_DNama, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel8Layout.createSequentialGroup()
                                .addComponent(jLabel20, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addComponent(jScrollPane4))))
                .addContainerGap())
        );

        tabel_histori.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane3.setViewportView(tabel_histori);

        jLabel17.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel17.setText("RIWAYAT PEMAKAIAN AIR PELANGGAN");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane3)
                    .addComponent(jLabel17, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel17)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 162, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout dialog_historiLayout = new javax.swing.GroupLayout(dialog_histori.getContentPane());
        dialog_histori.getContentPane().setLayout(dialog_historiLayout);
        dialog_historiLayout.setHorizontalGroup(
            dialog_historiLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        dialog_historiLayout.setVerticalGroup(
            dialog_historiLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(dialog_historiLayout.createSequentialGroup()
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        dialog_cariPHistori.getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel9.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel9.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel10.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel10.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel25.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel25.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel25.setText("DATA PELANGGANN");
        jPanel10.add(jLabel25, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 640, 40));

        jPanel9.add(jPanel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 660, 70));

        jLabel26.setText("KEYWORD");
        jPanel9.add(jLabel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 100, 100, 20));

        text_keyP2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                text_keyP2KeyReleased(evt);
            }
        });
        jPanel9.add(text_keyP2, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 100, 470, -1));

        tabel_pelangganP2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tabel_pelangganP2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tabel_pelangganP2MouseClicked(evt);
            }
        });
        jScrollPane5.setViewportView(tabel_pelangganP2);

        jPanel9.add(jScrollPane5, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 140, 620, 220));

        dialog_cariPHistori.getContentPane().add(jPanel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 660, 380));

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel2.setBackground(new java.awt.Color(153, 153, 255));
        jPanel2.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setText("SISTEM INFORMASI PENGELOLAAN AIR BERSIH");

        label_namaDesa.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        label_namaDesa.setText("BADAN USAHA MILIK DESA <<NAMA DESA>>");

        label_alamatNotelp.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        label_alamatNotelp.setText("<<ALAMAT, NO TELP>>");

        label_kop.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addComponent(label_kop, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(label_alamatNotelp, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(label_namaDesa, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(label_namaDesa, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(label_alamatNotelp, javax.swing.GroupLayout.DEFAULT_SIZE, 22, Short.MAX_VALUE)
                .addContainerGap())
            .addComponent(label_kop, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jPanel3.setBackground(new java.awt.Color(255, 255, 255));
        jPanel3.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        label_noTrans.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        label_noTrans.setText("<<label_noTrans>>");

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel3.setText("NO PELANGGAN");

        text_noPelanggan.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                text_noPelangganKeyReleased(evt);
            }
        });

        button_pelanggan.setText("...");
        button_pelanggan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_pelangganActionPerformed(evt);
            }
        });

        label_status.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_status.setForeground(new java.awt.Color(255, 0, 0));
        label_status.setText("TIDAK DAPAT MEMASUKKAN DATA");

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel5.setText("NAMA");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel6.setText("ALAMAT");

        text_nama.setEditable(false);

        text_airlunas.setEditable(false);
        text_airlunas.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel8.setText("METER TERAKHIR");

        text_airterakhir.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        text_airterakhir.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                text_airterakhirKeyReleased(evt);
            }
        });

        text_alamat.setEditable(false);
        text_alamat.setColumns(20);
        text_alamat.setRows(5);
        jScrollPane1.setViewportView(text_alamat);

        button_simpan.setText("SIMPAN");
        button_simpan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_simpanActionPerformed(evt);
            }
        });

        jButton4.setText("BATAL");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        button_histori.setText("HISTORI PELANGGAN");
        button_histori.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_historiActionPerformed(evt);
            }
        });

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel10.setText("m³");

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel11.setText("m³");

        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel14.setText("METER AWAL");

        jLabel15.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel15.setText("FORM PEMAKAIAN AIR");

        label_tanggal.setFont(new java.awt.Font("Dialog", 1, 14)); // NOI18N
        label_tanggal.setText("<<label_tanggal>>");

        label_bulan.setFont(new java.awt.Font("Dialog", 1, 18)); // NOI18N
        label_bulan.setText("<<bulan>>");

        panel_perincian.setBackground(new java.awt.Color(255, 255, 255));
        panel_perincian.setBorder(javax.swing.BorderFactory.createTitledBorder("Perincian Biaya"));

        jLabel27.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel27.setText("METER AIR HARUS DIBAYAR");

        text_airdibayar.setEditable(false);
        text_airdibayar.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        text_airdibayar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                text_airdibayarKeyReleased(evt);
            }
        });

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel9.setText("m³");

        label_abodemen.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_abodemen.setText("<<abodemen>>");

        label_pertama.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_pertama.setText("<<pertama>>");

        label_kedua.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_kedua.setText("<<kedua>>");

        label_ketiga.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_ketiga.setText("<<selanjutnya>>");

        text_abodemen.setEditable(false);
        text_abodemen.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        text_pertama.setEditable(false);
        text_pertama.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        text_kedua.setEditable(false);
        text_kedua.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        text_ketiga.setEditable(false);
        text_ketiga.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        javax.swing.GroupLayout panel_perincianLayout = new javax.swing.GroupLayout(panel_perincian);
        panel_perincian.setLayout(panel_perincianLayout);
        panel_perincianLayout.setHorizontalGroup(
            panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panel_perincianLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panel_perincianLayout.createSequentialGroup()
                        .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addComponent(jLabel27, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(label_abodemen, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(label_pertama, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addComponent(label_ketiga, javax.swing.GroupLayout.PREFERRED_SIZE, 179, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED))
                    .addGroup(panel_perincianLayout.createSequentialGroup()
                        .addComponent(label_kedua, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(23, 23, 23)))
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panel_perincianLayout.createSequentialGroup()
                        .addComponent(text_airdibayar, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(text_abodemen, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_pertama, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_ketiga, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_kedua, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        panel_perincianLayout.setVerticalGroup(
            panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panel_perincianLayout.createSequentialGroup()
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel27)
                    .addComponent(text_airdibayar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(label_abodemen, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(panel_perincianLayout.createSequentialGroup()
                        .addComponent(text_abodemen, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(10, 10, 10)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(text_pertama, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(label_pertama))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(label_kedua)
                    .addComponent(text_kedua, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panel_perincianLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(panel_perincianLayout.createSequentialGroup()
                        .addGap(1, 1, 1)
                        .addComponent(text_ketiga))
                    .addComponent(label_ketiga, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(25, Short.MAX_VALUE))
        );

        label_total.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        label_total.setText("TOTAL BIAYA");

        text_total.setEditable(false);
        text_total.setFont(new java.awt.Font("Dialog", 1, 14)); // NOI18N
        text_total.setHorizontalAlignment(javax.swing.JTextField.RIGHT);

        button_sama.setText("=");
        button_sama.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_samaActionPerformed(evt);
            }
        });

        label_1.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_1.setText("1");

        label_2.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_2.setText("2");

        label_3.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        label_3.setText("3");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(jLabel15)
                                .addGap(23, 23, 23)
                                .addComponent(label_noTrans))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(jLabel3)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(text_noPelanggan, javax.swing.GroupLayout.PREFERRED_SIZE, 207, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(button_pelanggan)))
                        .addGap(101, 101, 101)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(label_tanggal, javax.swing.GroupLayout.PREFERRED_SIZE, 177, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(label_bulan, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel5)
                                    .addComponent(jLabel6)
                                    .addComponent(jLabel14)
                                    .addComponent(jLabel8))
                                .addGap(4, 4, 4)
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel3Layout.createSequentialGroup()
                                        .addComponent(text_airlunas, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(text_nama)
                                        .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 210, Short.MAX_VALUE))
                                    .addGroup(jPanel3Layout.createSequentialGroup()
                                        .addComponent(text_airterakhir, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(button_sama))))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(label_1)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(label_2)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(label_3)))
                        .addGap(22, 22, 22)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(label_status)
                            .addComponent(panel_perincian, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(label_total, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(100, 100, 100)
                                .addComponent(text_total, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE))))))
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(145, 145, 145)
                .addComponent(button_simpan, javax.swing.GroupLayout.PREFERRED_SIZE, 160, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(button_histori, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel15)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(label_noTrans)
                        .addComponent(label_tanggal, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(text_noPelanggan, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(button_pelanggan, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(label_bulan, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(panel_perincian, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(17, 17, 17)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(text_total, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(label_total, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addComponent(label_status)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(button_simpan, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(button_histori, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel5)
                            .addComponent(text_nama, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel6)
                            .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(text_airlunas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel8)
                            .addComponent(text_airterakhir, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(button_sama))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(label_1)
                            .addComponent(label_2)
                            .addComponent(label_3))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jMenu1.setBackground(java.awt.Color.black);
        jMenu1.setText("HOME");
        jMenu1.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N
        jMenu1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jMenu1MouseClicked(evt);
            }
        });
        jMenuBar1.add(jMenu1);

        jMenu2.setBackground(java.awt.Color.black);
        jMenu2.setText("BARANG");
        jMenu2.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N

        jMenuItem3.setBackground(java.awt.Color.white);
        jMenuItem3.setForeground(java.awt.Color.black);
        jMenuItem3.setText("Pembelian Barang");
        jMenuItem3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem3ActionPerformed(evt);
            }
        });
        jMenu2.add(jMenuItem3);

        jMenuItem13.setBackground(java.awt.Color.white);
        jMenuItem13.setForeground(java.awt.Color.black);
        jMenuItem13.setText("Pemakaian Barang");
        jMenuItem13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem13ActionPerformed(evt);
            }
        });
        jMenu2.add(jMenuItem13);

        jMenuBar1.add(jMenu2);

        jMenu3.setBackground(java.awt.Color.black);
        jMenu3.setText("PELANGGAN");
        jMenu3.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N

        jMenuItem9.setBackground(java.awt.Color.white);
        jMenuItem9.setForeground(java.awt.Color.black);
        jMenuItem9.setText("Pendaftaran Pelanggan Baru");
        jMenuItem9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem9ActionPerformed(evt);
            }
        });
        jMenu3.add(jMenuItem9);

        jMenuItem10.setBackground(java.awt.Color.white);
        jMenuItem10.setForeground(java.awt.Color.black);
        jMenuItem10.setText("Pemakaian Air Pelanggan");
        jMenuItem10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem10ActionPerformed(evt);
            }
        });
        jMenu3.add(jMenuItem10);

        jMenuItem11.setBackground(java.awt.Color.white);
        jMenuItem11.setForeground(java.awt.Color.black);
        jMenuItem11.setText("Pembayaran Rekening Air");
        jMenuItem11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem11ActionPerformed(evt);
            }
        });
        jMenu3.add(jMenuItem11);

        jMenuItem7.setBackground(java.awt.Color.white);
        jMenuItem7.setForeground(java.awt.Color.black);
        jMenuItem7.setText("Informasi Keluhan Pelanggan");
        jMenuItem7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem7ActionPerformed(evt);
            }
        });
        jMenu3.add(jMenuItem7);

        jMenuBar1.add(jMenu3);

        jMenu4.setBackground(java.awt.Color.black);
        jMenu4.setText("PENGELUARAN");
        jMenu4.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N

        jMenuItem1.setBackground(java.awt.Color.white);
        jMenuItem1.setForeground(java.awt.Color.black);
        jMenuItem1.setText("List Pengeluaran");
        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem1ActionPerformed(evt);
            }
        });
        jMenu4.add(jMenuItem1);

        jMenuItem5.setBackground(java.awt.Color.white);
        jMenuItem5.setForeground(java.awt.Color.black);
        jMenuItem5.setText("Pengeluaran Bulanan");
        jMenuItem5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem5ActionPerformed(evt);
            }
        });
        jMenu4.add(jMenuItem5);

        jMenuItem6.setBackground(java.awt.Color.white);
        jMenuItem6.setForeground(java.awt.Color.black);
        jMenuItem6.setText("Pembayaran Hutang");
        jMenuItem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem6ActionPerformed(evt);
            }
        });
        jMenu4.add(jMenuItem6);

        jMenuBar1.add(jMenu4);

        jMenu5.setBackground(java.awt.Color.black);
        jMenu5.setText("LAPORAN");
        jMenu5.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N

        jMenuItem4.setBackground(java.awt.Color.white);
        jMenuItem4.setForeground(java.awt.Color.black);
        jMenuItem4.setText("Laba - Rugi");
        jMenuItem4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem4ActionPerformed(evt);
            }
        });
        jMenu5.add(jMenuItem4);

        jMenuItem12.setBackground(java.awt.Color.white);
        jMenuItem12.setForeground(java.awt.Color.black);
        jMenuItem12.setText("Neraca");
        jMenuItem12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem12ActionPerformed(evt);
            }
        });
        jMenu5.add(jMenuItem12);

        jMenuBar1.add(jMenu5);

        jMenu6.setBackground(java.awt.Color.black);
        jMenu6.setText("PENGATURAN");
        jMenu6.setFont(new java.awt.Font("SansSerif", 1, 12)); // NOI18N

        jMenuItem14.setBackground(java.awt.Color.white);
        jMenuItem14.setForeground(java.awt.Color.black);
        jMenuItem14.setText("Investasi Awal");
        jMenuItem14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem14ActionPerformed(evt);
            }
        });
        jMenu6.add(jMenuItem14);

        jMenuItem8.setBackground(java.awt.Color.white);
        jMenuItem8.setForeground(java.awt.Color.black);
        jMenuItem8.setText("Profil Desa");
        jMenuItem8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem8ActionPerformed(evt);
            }
        });
        jMenu6.add(jMenuItem8);

        jMenuItem2.setBackground(java.awt.Color.white);
        jMenuItem2.setForeground(java.awt.Color.black);
        jMenuItem2.setText("Pengaturan Persentase Laba Bersih");
        jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem2ActionPerformed(evt);
            }
        });
        jMenu6.add(jMenuItem2);

        jMenuBar1.add(jMenu6);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 8, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void tabel_pelangganMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabel_pelangganMouseClicked
        int row1 = tabel_pelanggan.getSelectedRow();
        //set identitas ke dalam textfield
        text_noPelanggan.setText(tabel_pelanggan.getValueAt(row1, 0).toString());
        text_nama.setText(tabel_pelanggan.getValueAt(row1, 1).toString());
        text_alamat.setText(tabel_pelanggan.getValueAt(row1, 2).toString());

        //cari pemakaian air bulan ini
        String jatuhTempo = cariTanggalJatuhTempo();
        Pemakaian pem = new Pemakaian();
        pem.setIdanggota(new Anggota(text_noPelanggan.getText(), jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, row1, row1, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo));
        pem.setJatuhtempo(jatuhTempo);
        try {
            pem = PemakaianKontrol.getKoneksi().selectPemakaian(pem);
            label_noTrans.setText(pem.getNotransaksi());
            if (pem.getNotransaksi() == null) {//kalo kosong, buat baru
                JOptionPane.showMessageDialog(null, "Buat Baru");
                //cek riwayat tunggakan pengguna
                List<Pemakaian> riwayat = PemakaianKontrol.getKoneksi().cekDendaPelanggan(new Pemakaian(jatuhTempo, new Anggota(text_noPelanggan.getText(), jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, row1, row1, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo), row1, row1, row1, jatuhTempo, jatuhTempo));
                if (riwayat.size() >= 3) {
                    JOptionPane.showMessageDialog(null, "Anggota ini telah denda lebih dari 3 bulan, pemakaian bulan ini akan diputus sementara sampai anggota yang bersangkutan telah membayar");
                    text_airterakhir.setEditable(false);
                    label_status.setVisible(true);
                } else {
                    text_airterakhir.setEditable(true);
                    label_status.setVisible(false);

                    //cari data bln sblmnya
                    List<Pemakaian> pn = PemakaianKontrol.getKoneksi().selectHistoriPemakaian(text_noPelanggan.getText());
                    pem = cekTerbesar(pn);
//                    String tanggalSblm = cariTanggalJatuhTempoSblm();
//                    pem.setIdanggota(new Anggota(text_noPelanggan.getText(), jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, row1, row1, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo, jatuhTempo));
//                    pem.setJatuhtempo(tanggalSblm);
//                    pem = PemakaianKontrol.getKoneksi().selectPemakaian2(pem);

                    //kemudian insert baru
                    String kodebaru = generateKodeBaru(pem.getNotransaksi());
                    Pemakaian dataBaru = new Pemakaian(kodebaru,
                            pem.getIdanggota(), pem.getAirterakhir(), 0, 0, label_bulan.getText(), jatuhTempo);
                    PemakaianKontrol.getKoneksi().insertPemakaian(dataBaru);

                    //insert ke transaksi sebagai piutang
                    Transaksi trans = new Transaksi();
                    trans.setNoTrans(dataBaru.getNotransaksi());
                    trans.setIdAnggota(dataBaru.getIdanggota());
                    trans.setJumlah((int) dataBaru.getAirdibayar());
                    trans.setHargaSatuan(0);
                    trans.setDenda(0);
                    Konfigurasi konfig = KonfigurasiKontrol.getKoneksi().selectKonfigurasi();
                    trans.setTotal(konfig.getAbodemen());
                    TransaksiKontrol.getKoneksi().jual_insertTransaksi(trans);

                    //tampilkan
                    text_airlunas.setText(FormatRibuan.pisahRibuan(Double.toString(dataBaru.getAirlunas()).split("\\.")[0]));
                    text_airterakhir.setText(FormatRibuan.pisahRibuan(Double.toString(dataBaru.getAirterakhir()).split("\\.")[0]));
                    text_airdibayar.setText(FormatRibuan.pisahRibuan(Double.toString(dataBaru.getAirdibayar()).split("\\.")[0]));
                    label_noTrans.setText(dataBaru.getNotransaksi());
//                text_airterakhir.setEditable(true);
                    label_noTrans.setVisible(true);
                }

            } else {
                text_airlunas.setText(FormatRibuan.pisahRibuan(Double.toString(pem.getAirlunas()).split("\\.")[0]));
                text_airterakhir.setText(FormatRibuan.pisahRibuan(Double.toString(pem.getAirterakhir()).split("\\.")[0]));
                text_airdibayar.setText(FormatRibuan.pisahRibuan(Double.toString(pem.getAirdibayar()).split("\\.")[0]));
                if (text_airlunas.getText().equals(text_airterakhir.getText()) && !text_airlunas.getText().equals("0")) {
                    JOptionPane.showMessageDialog(null, "Pemakaian Air pelanggan LUNAS");
                    text_airterakhir.setEditable(false);
                } else if (text_airterakhir.getText().equals("0")) {
                    text_airterakhir.setEditable(true);
                } else {
                    JOptionPane.showMessageDialog(null, "Anda tidak dapat mengubah data air!");
                    button_simpan.setEnabled(false);
                    text_airterakhir.setEditable(false);
//                    List<Pemakaian> riwayat = PemakaianKontrol.getKoneksi().cekDendaPelanggan(pem);
//                    if (riwayat.size() >= 3) {
//                        JOptionPane.showMessageDialog(null, "Anggota ini telah denda lebih dari 3 bulan, pemakaian bulan ini akan diputus sementara sampai anggota yang bersangkutan telah membayar");
//                        text_airterakhir.setEditable(false);
//                        label_status.setVisible(true);
//                    } else {
//                        text_airterakhir.setEditable(true);
//                        label_status.setVisible(false);
//                    }
//                    label_noTrans.setVisible(true);
                }
            }
            dialog_cariP.setVisible(false);
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }
        buatPerincian();
    }//GEN-LAST:event_tabel_pelangganMouseClicked

    private void text_keyKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_text_keyKeyReleased
        if (text_key.getText().equals("")) {
            update("");
        } else {
            update(text_key.getText());
        }
    }//GEN-LAST:event_text_keyKeyReleased

    private void button_pelangganActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_pelangganActionPerformed
        update("");
        dialog_cariP.setVisible(true);
    }//GEN-LAST:event_button_pelangganActionPerformed

    private void text_airterakhirKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_text_airterakhirKeyReleased
        if (text_airterakhir.getText().equals("")) {
            text_airterakhir.setText("0");
            buatPerincian();
        } else {
            text_airterakhir.setText(FormatRibuan.pisahRibuan(text_airterakhir.getText()));
            buatPerincian();
        }
        if (Double.parseDouble(text_airterakhir.getText()) >= Double.parseDouble(text_airlunas.getText())) {
            button_simpan.setEnabled(true);
        } else {
            button_simpan.setEnabled(false);
        }
    }//GEN-LAST:event_text_airterakhirKeyReleased

    private void button_simpanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_simpanActionPerformed
        if (Integer.parseInt(text_airdibayar.getText()) < 0) {
            JOptionPane.showMessageDialog(null, "TIDAK DAPAT MENYIMPAN DATA. \n"
                    + "DEBIT AIR YANG HARUS DIBAYAR tidak boleh kurang dari 0!\n"
                    + "klik tombol '=' jika pelanggan tidak memakai air di bulan " + label_bulan.getText());
        } else {
            try {
                Pemakaian pem = new Pemakaian();
                pem.setNotransaksi(label_noTrans.getText());
                pem.setIdanggota(new Anggota(text_noPelanggan.getText(), text_nama.getText(), "", "", "", "", 0, 0, "", "", "", "", ""));
                pem.setAirlunas(Double.parseDouble(FormatRibuan.gabungRibuan(text_airlunas.getText())));
                pem.setAirterakhir(Double.parseDouble(FormatRibuan.gabungRibuan(text_airterakhir.getText())));
                pem.setAirdibayar(Double.parseDouble(FormatRibuan.gabungRibuan(text_airdibayar.getText())));

                PemakaianKontrol.getKoneksi().updatePemakaian(pem);

                //insert transaksi (piutang)
                Transaksi trans = new Transaksi();
                trans.setNoTrans(label_noTrans.getText());
                trans.setIdAnggota(new Anggota(text_noPelanggan.getText()));
                trans.setJumlah((int) pem.getAirdibayar());
                trans.setHargaSatuan(0);
                trans.setDenda(0);
                trans.setTotal(Double.parseDouble(FormatRibuan.gabungRibuan(text_total.getText())));
                TransaksiKontrol.getKoneksi().jual_insertTransaksi(trans);

                //pendapatan piutang (piutang (debit), modal(debit)/sementara)
                Trans piutang = new Trans("1.1.3", (long) trans.getTotal(), 0);
                Trans modal = new Trans("3.1.1", (long) trans.getTotal(), 0);
                TransKontrol.getKoneksi().insertTransaksi(piutang);
                TransKontrol.getKoneksi().insertTransaksi(modal);

                JOptionPane.showMessageDialog(null, "Pemakaian air pelanggan berhasil dirubah!");
                cetakStruk(pem);
                resetDefault();
            } catch (SQLException ex) {
                Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_button_simpanActionPerformed

    private void text_noPelangganKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_text_noPelangganKeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_text_noPelangganKeyReleased

    private void button_historiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_historiActionPerformed
        dialog_histori.setVisible(true);
    }//GEN-LAST:event_button_historiActionPerformed

    private void text_keyP2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_text_keyP2KeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_text_keyP2KeyReleased

    private void tabel_pelangganP2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabel_pelangganP2MouseClicked
        try {
            int row1 = tabel_pelangganP2.getSelectedRow();
            //set ke dalam text fieldnya
            text_DNoPelanggan.setText(tabel_pelangganP2.getValueAt(row1, 0).toString());
            text_DNama.setText(tabel_pelangganP2.getValueAt(row1, 1).toString());
            text_DAlamat.setText(tabel_pelangganP2.getValueAt(row1, 2).toString());
            text_DDusun.setText(tabel_pelangganP2.getValueAt(row1, 3).toString());
            text_DNoTelp.setText(tabel_pelangganP2.getValueAt(row1, 4).toString());
            Anggota agt = AnggotaKontrol.getKoneksi().selectAnggota(text_DNoPelanggan.getText());
            text_DRT.setText(Integer.toString(agt.getRt()));
            text_DRW.setText(Integer.toString(agt.getRw()));

            // tampilkan riwayat pelanggan
            List<Pemakaian> pm = PemakaianKontrol.getKoneksi().selectHistoriPemakaian(text_DNoPelanggan.getText());
            HistoriTM model = new HistoriTM(pm);
            tabel_histori.setModel(model);
            tabel_histori.setDefaultRenderer(Object.class, new RenderWarnaWarni(Color.white, Color.yellow, Color.green));
            dialog_cariPHistori.setVisible(false);
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_tabel_pelangganP2MouseClicked

    private void button_cariActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_cariActionPerformed
        update("");
        dialog_cariPHistori.setVisible(true);
    }//GEN-LAST:event_button_cariActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        resetDefault();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void text_airdibayarKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_text_airdibayarKeyReleased

    }//GEN-LAST:event_text_airdibayarKeyReleased

    private void button_samaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_samaActionPerformed
        text_airterakhir.setText(text_airlunas.getText());
        text_airdibayar.setText("0");

        //konfigurasi perincian dana
        int pertama = konfig.getPertama();
        int kedua = konfig.getKedua();
        int selanjutnya = konfig.getKetiga();
        int abodemen = konfig.getAbodemen();
        int airBagi = konfig.getBagimeter();
        int bagiAir = konfig.getBagimeter();

        label_abodemen.setText("ABODEMEN : ");
        text_abodemen.setText(Integer.toString(abodemen));
        label_pertama.setText("0 Pertama (" + pertama + "/m3) " + ": ");
        text_pertama.setText("0");
        label_kedua.setText("0 Kedua (" + kedua + "/m3) " + ": ");
        text_kedua.setText("0");
        label_ketiga.setText("0 Air Berikut (" + selanjutnya + "/m3) " + ": ");
        text_ketiga.setText("0");
        double total = Double.parseDouble(text_abodemen.getText()) + Double.parseDouble(text_pertama.getText())
                + Double.parseDouble(text_kedua.getText()) + Double.parseDouble(text_ketiga.getText());
        text_total.setText(Double.toString(total).split("\\.")[0]);

        button_simpan.setEnabled(true);
    }//GEN-LAST:event_button_samaActionPerformed

    private void jMenu1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu1MouseClicked
        FormAir a = new FormAir();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenu1MouseClicked

    private void jMenuItem3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem3ActionPerformed
        FormBarang a = new FormBarang();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem3ActionPerformed

    private void jMenuItem13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem13ActionPerformed
        FormTransaksiPemakaianBarang a = new FormTransaksiPemakaianBarang();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem13ActionPerformed

    private void jMenuItem9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem9ActionPerformed
        FormAnggota a = new FormAnggota();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem9ActionPerformed

    private void jMenuItem10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem10ActionPerformed
        FormPemakaianAir a = new FormPemakaianAir();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem10ActionPerformed

    private void jMenuItem11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem11ActionPerformed
        FormTransaksiPenjualan a = new FormTransaksiPenjualan();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem11ActionPerformed

    private void jMenuItem7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem7ActionPerformed
        FormKeluhan a = new FormKeluhan();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem7ActionPerformed

    private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
        FormPengeluaran a = new FormPengeluaran();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem1ActionPerformed

    private void jMenuItem5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem5ActionPerformed
        FormTransaksiPengeluaran a = new FormTransaksiPengeluaran();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem5ActionPerformed

    private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem6ActionPerformed
        FormTransaksiPembayaranHutang a = new FormTransaksiPembayaranHutang();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem6ActionPerformed

    private void jMenuItem4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem4ActionPerformed
        FormLabaRugi a = new FormLabaRugi();
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem4ActionPerformed

    private void jMenuItem12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem12ActionPerformed
        FormNeraca a = new FormNeraca();
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem12ActionPerformed

    private void jMenuItem14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem14ActionPerformed
        FormInvesAwal a = new FormInvesAwal();
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem14ActionPerformed

    private void jMenuItem8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem8ActionPerformed
        FormPengaturan a = new FormPengaturan();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem8ActionPerformed

    private void jMenuItem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem2ActionPerformed
        FormSHU a = new FormSHU();
        this.setVisible(false);
        a.setVisible(true);
    }//GEN-LAST:event_jMenuItem2ActionPerformed

    public void update(String key) {
        try {
            List<Anggota> agt = AnggotaKontrol.getKoneksi().selectAnggota2(key);
            AnggotaTM model = new AnggotaTM(agt);
            tabel_pelanggan.setModel(model);
            tabel_pelangganP2.setModel(model);// tambah ini buat tabel sama di P2
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public void resetDefault() {
        text_noPelanggan.setText("");
        text_nama.setText("");
        text_alamat.setText("");
        text_airlunas.setText("");
        text_airdibayar.setText("");
        label_noTrans.setText("");
        text_airterakhir.setText("");
        label_noTrans.setVisible(false);
        label_status.setVisible(false);
        button_simpan.setEnabled(false);
    }

    public String konversiBulan(String B) {
        String bulan = B.split("-")[1];
        if (bulan.equals("JANUARI")) {
            return "01";
        } else if (bulan.equals("FEBRUARI")) {
            return "02";
        } else if (bulan.equals("MARET")) {
            return "03";
        } else if (bulan.equals("APRIL")) {
            return "04";
        } else if (bulan.equals("MEI")) {
            return "05";
        } else if (bulan.equals("JUNI")) {
            return "06";
        } else if (bulan.equals("JULI")) {
            return "07";
        } else if (bulan.equals("AGUSTUS")) {
            return "08";
        } else if (bulan.equals("SEPTEMBER")) {
            return "09";
        } else if (bulan.equals("OKTOBER")) {
            return "10";
        } else if (bulan.equals("NOVEMBER")) {
            return "11";
        } else if (bulan.equals("DESEMBER")) {
            return "12";
        } else if (bulan.equals("01")) {
            return "JANUARI";
        } else if (bulan.equals("02")) {
            return "FEBRUARI";
        } else if (bulan.equals("03")) {
            return "MARET";
        } else if (bulan.equals("04")) {
            return "APRIL";
        } else if (bulan.equals("05")) {
            return "MEI";
        } else if (bulan.equals("06")) {
            return "JUNI";
        } else if (bulan.equals("07")) {
            return "JULI";
        } else if (bulan.equals("08")) {
            return "AGUSTUS";
        } else if (bulan.equals("09")) {
            return "SEPTEMBER";
        } else if (bulan.equals("10")) {
            return "OKTOBER";
        } else if (bulan.equals("11")) {
            return "NOVEMBER";
        } else if (bulan.equals("12")) {
            return "DESEMBER";
        } else {
            return "-";
        }
    }

    public String generateBulanTahun(String tanggal) {
        if (tanggal.split("-")[1].equals("01")) {
            return "JANUARI-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("02")) {
            return "FEBRUARI-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("03")) {
            return "MARET-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("04")) {
            return "APRIL-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("05")) {
            return "MEI-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("06")) {
            return "JUNI-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("07")) {
            return "JULI-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("08")) {
            return "AGUSTUS-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("09")) {
            return "SEPTEMBER-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("10")) {
            return "OKTOBER-" + tanggal.split("-")[0];
        } else if (tanggal.split("-")[1].equals("11")) {
            return "NOVEMBER-" + tanggal.split("-")[0];
        } else {
            return "DESEMBER-" + tanggal.split("-")[0];
        }
    }

    public String cariTanggalJatuhTempo() {
        Konfigurasi konfig = null;
        try {
            konfig = KonfigurasiKontrol.getKoneksi().selectKonfigurasi();
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }

        String tanggal = Tanggal.getTanggal2();//ambil tanggal sekarang
        String jatuhTempo = "";
        if (tanggal.split("-")[1].equals("12")) {//kalo bulan desember, jatuh tempo ke bln 1 thn selanjutnya
            String tgl = Integer.toString(konfig.getTglTerakhir());
            String bulan = "01";
            int tahun = Integer.parseInt(tanggal.split("-")[0]);
            tahun = tahun + 1;
            jatuhTempo = Integer.toString(tahun) + "-" + bulan + "-" + tgl;
        } else {
            String tgl = Integer.toString(konfig.getTglTerakhir());
            int bulan = Integer.parseInt(tanggal.split("-")[1]);
            String bln = "";
            if (bulan >= 9) {
                bulan = bulan + 1;
                bln = Integer.toString(bulan);
            } else {
                bulan = bulan + 1;
                bln = "0" + Integer.toString(bulan);
            }
            String tahun = tanggal.split("-")[0];
            jatuhTempo = tahun + "-" + bln + "-" + tgl;
        }
        return jatuhTempo;
    }

    public String cariTanggalJatuhTempoSblm() {
        Konfigurasi konfig = null;
        try {
            konfig = KonfigurasiKontrol.getKoneksi().selectKonfigurasi();
        } catch (SQLException ex) {
            Logger.getLogger(FormPemakaianAir.class.getName()).log(Level.SEVERE, null, ex);
        }

        String tanggal = Tanggal.getTanggal2();
        String jatuhTempo = "";
        int bulan = Integer.parseInt(tanggal.split("-")[1]);

        if (bulan <= 9) {
            jatuhTempo = tanggal.split("-")[0] + "-0" + Integer.toString(bulan) + "-" + Integer.toString(konfig.getTglTerakhir());
        } else {
            jatuhTempo = tanggal.split("-")[0] + "-" + Integer.toString(bulan) + "-" + Integer.toString(konfig.getTglTerakhir());
        }
        return jatuhTempo;
    }

    public String generateKodeBaru(String kode) {
        int noTa = Integer.parseInt(kode.split("-")[1]);
        noTa = noTa + 1;
//        System.out.println(kode.split("-")[0] + "-" + noTa);
        return kode.split("-")[0] + "-" + noTa;
    }

    public void sinkronGambar() {
        try {
            Profil prof = PengaturanKontrol.getKoneksi().tampilProfil();
            label_namaDesa.setText("BADAN USAHA MILIK DESA " + prof.getNamadesa());
            label_alamatNotelp.setText(prof.getAlamatdesa() + " " + prof.getDesa() + " " + prof.getKecamatan()
                    + " " + prof.getKabupaten() + " " + prof.getProvinsi()
                    + " - " + prof.getNotelp());

            String path = new File(".").getCanonicalPath() + "/Gambar/" + prof.getLogo();

            Toolkit toolkit = Toolkit.getDefaultToolkit();
            Image image = toolkit.getImage(path);
            Image imagedResized = image.getScaledInstance(110, 100, Image.SCALE_DEFAULT);
            ImageIcon imageIcon = new ImageIcon(imagedResized);
            label_kop.setIcon(imageIcon);
        } catch (IOException ex) {
            Logger.getLogger(FormPengaturan.class.getName()).log(Level.SEVERE, null, ex);
        } catch (SQLException ex) {
            Logger.getLogger(FormPengaturan.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(FormPemakaianAir.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(FormPemakaianAir.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(FormPemakaianAir.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(FormPemakaianAir.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FormPemakaianAir().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton button_cari;
    private javax.swing.JButton button_histori;
    private javax.swing.JButton button_pelanggan;
    private javax.swing.JButton button_sama;
    private javax.swing.JButton button_simpan;
    private javax.swing.JDialog dialog_cariP;
    private javax.swing.JDialog dialog_cariPHistori;
    private javax.swing.JDialog dialog_histori;
    private javax.swing.JButton jButton4;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenu jMenu3;
    private javax.swing.JMenu jMenu4;
    private javax.swing.JMenu jMenu5;
    private javax.swing.JMenu jMenu6;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JMenuItem jMenuItem10;
    private javax.swing.JMenuItem jMenuItem11;
    private javax.swing.JMenuItem jMenuItem12;
    private javax.swing.JMenuItem jMenuItem13;
    private javax.swing.JMenuItem jMenuItem14;
    private javax.swing.JMenuItem jMenuItem2;
    private javax.swing.JMenuItem jMenuItem3;
    private javax.swing.JMenuItem jMenuItem4;
    private javax.swing.JMenuItem jMenuItem5;
    private javax.swing.JMenuItem jMenuItem6;
    private javax.swing.JMenuItem jMenuItem7;
    private javax.swing.JMenuItem jMenuItem8;
    private javax.swing.JMenuItem jMenuItem9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JLabel label_1;
    private javax.swing.JLabel label_2;
    private javax.swing.JLabel label_3;
    private javax.swing.JLabel label_abodemen;
    private javax.swing.JLabel label_alamatNotelp;
    private javax.swing.JLabel label_bulan;
    private javax.swing.JLabel label_kedua;
    private javax.swing.JLabel label_ketiga;
    private javax.swing.JLabel label_kop;
    private javax.swing.JLabel label_namaDesa;
    private javax.swing.JLabel label_noTrans;
    private javax.swing.JLabel label_pertama;
    private javax.swing.JLabel label_status;
    private javax.swing.JLabel label_tanggal;
    private javax.swing.JLabel label_total;
    private javax.swing.JPanel panel_perincian;
    private javax.swing.JTable tabel_histori;
    private javax.swing.JTable tabel_pelanggan;
    private javax.swing.JTable tabel_pelangganP2;
    private javax.swing.JTextArea text_DAlamat;
    private javax.swing.JTextField text_DDusun;
    private javax.swing.JTextField text_DNama;
    private javax.swing.JTextField text_DNoPelanggan;
    private javax.swing.JTextField text_DNoTelp;
    private javax.swing.JTextField text_DRT;
    private javax.swing.JTextField text_DRW;
    private javax.swing.JTextField text_abodemen;
    private javax.swing.JTextField text_airdibayar;
    private javax.swing.JTextField text_airlunas;
    private javax.swing.JTextField text_airterakhir;
    private javax.swing.JTextArea text_alamat;
    private javax.swing.JTextField text_kedua;
    private javax.swing.JTextField text_ketiga;
    private javax.swing.JTextField text_key;
    private javax.swing.JTextField text_keyP2;
    private javax.swing.JTextField text_nama;
    private javax.swing.JTextField text_noPelanggan;
    private javax.swing.JTextField text_pertama;
    private javax.swing.JTextField text_total;
    // End of variables declaration//GEN-END:variables

    private void cetakStruk(Pemakaian pem) {
        Connection kon = null;
        Koneksi con = new Koneksi();
        kon = con.getConnection();

        String reportSource = "./src/Lap/InformasiPembayaranAir.jasper";
        //INFORMASI PEMBAYARAN REKENING AIR
        Map<String, Object> params = new HashMap<String, Object>();
        params.put("noTrans", pem.getNotransaksi());
        params.put("tahun", Tanggal.getTanggal2().split("-")[0]);
        params.put("alamat", text_alamat.getText());

        params.put("t_abodemen", text_abodemen.getText());
        params.put("t_pertama", text_pertama.getText());
        params.put("t_kedua", text_kedua.getText());
        params.put("t_selanjutnya", text_ketiga.getText());
        params.put("t_total", text_total.getText());
        params.put("t_1", label_1.getText());
        params.put("t_2", label_2.getText());
        params.put("t_3", label_3.getText());
        try {
            JasperPrint jasperPrint = JasperFillManager.fillReport(reportSource, params, kon);
            JasperViewer.viewReport(jasperPrint, false);

        } catch (JRException ex) {
            ex.printStackTrace();
        }
    }

    public void buatPerincian() {
        double selisih = Double.parseDouble(text_airterakhir.getText()) - Double.parseDouble(text_airlunas.getText());
        text_airdibayar.setText(Double.toString(selisih).split("\\.")[0]);

        //konfigurasi perincian dana
        int pertama = konfig.getPertama();
        int kedua = konfig.getKedua();
        int selanjutnya = konfig.getKetiga();
        int abodemen = konfig.getAbodemen();
        int airBagi = konfig.getBagimeter();
        int bagiAir = konfig.getBagimeter();

        if (selisih > 20) {
//               JOptionPane.showMessageDialog(null, "Lebih dari 20");
            label_abodemen.setText("ABODEMEN : ");
            text_abodemen.setText(FormatRibuan.pisahRibuan(Integer.toString(abodemen)));
            label_pertama.setText(Integer.toString(bagiAir) + " Pertama (" + pertama + "/m3) " + ": ");
            text_pertama.setText(FormatRibuan.pisahRibuan(Integer.toString(10 * pertama)));
            label_kedua.setText(Integer.toString(bagiAir) + " Kedua (" + kedua + "/m3) " + ": ");
            text_kedua.setText(FormatRibuan.pisahRibuan(Integer.toString(10 * kedua)));
            double sisa = selisih - 20;
            label_ketiga.setText(Double.toString(sisa).split("\\.")[0] + " Air Berikut (" + selanjutnya + "/m3) " + ": ");
            text_ketiga.setText(FormatRibuan.pisahRibuan(Double.toString(sisa * selanjutnya).split("\\.")[0]));
            double total = Double.parseDouble(text_abodemen.getText()) + Double.parseDouble(text_pertama.getText())
                    + Double.parseDouble(text_kedua.getText()) + Double.parseDouble(text_ketiga.getText());
            text_total.setText(FormatRibuan.pisahRibuan(Double.toString(total).split("\\.")[0]));

            label_1.setText("10");
            label_2.setText("10");
            label_3.setText(Double.toString(sisa).split("\\.")[0]);
        } else if (selisih > 10 && selisih <= 20) {
//                JOptionPane.showMessageDialog(null, "Lebih dari 10");
            label_abodemen.setText("ABODEMEN : ");
            text_abodemen.setText(FormatRibuan.pisahRibuan(Integer.toString(abodemen)));
            label_pertama.setText(Integer.toString(bagiAir) + " Pertama (" + pertama + "/m3) " + ": ");
            text_pertama.setText(FormatRibuan.pisahRibuan(Integer.toString(10 * pertama)));
            double sisa = selisih - bagiAir;
            label_kedua.setText(Double.toString(sisa).split("\\.")[0] + " Kedua (" + kedua + "/m3) " + ": ");
            text_kedua.setText(FormatRibuan.pisahRibuan(Double.toString(sisa * kedua).split("\\.")[0]));
            label_ketiga.setText("0 Air Berikut (" + selanjutnya + "/m3) " + ": ");
            text_ketiga.setText("0");
            double total = Double.parseDouble(text_abodemen.getText()) + Double.parseDouble(text_pertama.getText())
                    + Double.parseDouble(text_kedua.getText()) + Double.parseDouble(text_ketiga.getText());
            text_total.setText(FormatRibuan.pisahRibuan(Double.toString(total).split("\\.")[0]));

            label_1.setText("10");
            label_2.setText(Double.toString(sisa).split("\\.")[0]);
            label_3.setText("0");
        } else if (selisih > 0 && selisih <= 10) {
            label_abodemen.setText("ABODEMEN : ");
            text_abodemen.setText(FormatRibuan.pisahRibuan(Integer.toString(abodemen)));
            double sisa = selisih;
            label_pertama.setText(Double.toString(sisa).split("\\.")[0] + " Pertama (" + pertama + "/m3) " + ": ");
            text_pertama.setText(FormatRibuan.pisahRibuan(Double.toString(sisa * pertama).split("\\.")[0]));
            label_kedua.setText("0 Kedua (" + kedua + "/m3) " + ": ");
            text_kedua.setText("0");
            label_ketiga.setText("0 Air Berikut (" + selanjutnya + "/m3) " + ": ");
            text_ketiga.setText("0");
            double total = Double.parseDouble(text_abodemen.getText()) + Double.parseDouble(text_pertama.getText())
                    + Double.parseDouble(text_kedua.getText()) + Double.parseDouble(text_ketiga.getText());
            text_total.setText(FormatRibuan.pisahRibuan(Double.toString(total).split("\\.")[0]));

            label_1.setText(Double.toString(sisa).split("\\.")[0]);
            label_2.setText("0");
            label_3.setText("0");
        } else {//hanya bayar abodemen
            label_abodemen.setText("ABODEMEN : ");
            text_abodemen.setText(FormatRibuan.pisahRibuan(Integer.toString(abodemen)));
            label_pertama.setText("0 Pertama (" + pertama + "/m3) " + ": ");
            text_pertama.setText("0");
            label_kedua.setText("0 Kedua (" + kedua + "/m3) " + ": ");
            text_kedua.setText("0");
            label_ketiga.setText("0 Air Berikut (" + selanjutnya + "/m3) " + ": ");
            text_ketiga.setText("0");
            double total = Double.parseDouble(text_abodemen.getText()) + Double.parseDouble(text_pertama.getText())
                    + Double.parseDouble(text_kedua.getText()) + Double.parseDouble(text_ketiga.getText());
            text_total.setText(FormatRibuan.pisahRibuan(Double.toString(total).split("\\.")[0]));

            label_1.setText("0");
            label_2.setText("0");
            label_3.setText("0");
        }
    }

    public Pemakaian cekTerbesar(List<Pemakaian> pem) {
        int temp = 0;
        int index = 0;
        for (int i = 0; i < pem.size(); i++) {
            if (Integer.parseInt(pem.get(i).getNotransaksi().split("-")[1]) > temp) {
                temp = Integer.parseInt(pem.get(i).getNotransaksi().split("-")[1]);
                index = i;
            } else {
                temp = temp;
                index = index;
            }
        }
        return pem.get(index);
    }
}
